<!DOCTYPE html>

<html>
  <head>
    <title>test</title>
  </head>
 
  <body>   
    <p id="text"></p>
    <script type="application/dart" src="browser_test.dart"></script>
    <!-- for this next line to work, your pubspec.yaml file must have a dependency on 'browser' -->
    <script src="packages/browser/dart.js"></script>
    <script>
      // only run if testRunner is defined -- we're in DRT
      if (window.testRunner) {
    
        // Don't dump the structure. Just the text of the output plus console output
        testRunner.dumpAsText();
    
        // Don't finish when layout is done. Instead, wait to be notified
        testRunner.waitUntilDone();
    
        // listen for messages from the test harness
        window.addEventListener("message", receiveMessage, false);
    
        // listen for unhandled exceptions
        window.addEventListener('error', onError);
      }
    
      // if there is an unhandled exception, tell DRT we're done
      function onError(event) {
        testRunner.notifyDone();
      }
    
      // if the test harness sends a done message, tell DRT we're done
      function receiveMessage(event) {
        console.log(event.data);
        if(event.data == 'unittest-suite-done') {
          testRunner.notifyDone();
        }
      }
    </script>
  </body>
</html>
